# An Algorithm That Combines Genetic and Image Features for Outcome Prediction

Summary: This study proposes a multimodal fusion machine learning model that integrates histopathological images and gene expression data. To address the high dimensionality of the genomic modality, we designed a feature extraction strategy that incorporates pathway layers and self-normalizing neural networks. For image data, convolutional neural networks were employed. Features from both modalities were fused using tensor product fusion and optimized using the Cox loss function, with the concordance index used as the evaluation metric.
![alt text](model_2.png)

# Setup
- argparse: 1.1
- torch: 1.13.1+cu116
- pandas: 2.2.3
- torchvision: 0.14.1+cu116
- torch_geometric: 2.6.1
- PIL: 10.4.0
- numpy: 1.26.4
- lifelines: 0.30.0
- matplotlib: 3.9.2

# Code Base Structure
The code base structure is explained below:

- `data_loader.py` is used to load the data required for training and testing, and returns the data in the correct format for the PyTorch DataLoader according to the model's requirements.
- `loss_function.py` provides the CoxLoss for training and evaluating survival analysis models.
`main.py` is the main program, handling data, model setup, training, evaluation, and result visualization for the survival analysis workflow.

- `network.py` contains PyTorch model definitions for all unimodal and multimodal network.
- `train_test.py` Contains the definitions for "train" and "test".
